/* build date: 2016-07-19T14:51:16+0800 */ var Mustache;(function(e){typeof module!="undefined"&&module.exports?module.exports=e:typeof define=="function"?define("mustache",e):Mustache=e})(function(){function u(e,t){return RegExp.prototype.test.call(e,t)}function a(e){return!u(r,e)}function l(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function h(e){return String(e).replace(/[&<>"'\/]/g,function(e){return c[e]})}function p(e){this.string=e,this.tail=e,this.pos=0}function d(e,t){this.view=e,this.parent=t,this.clearCache()}function v(){this.clearCache()}function m(e){var t=e[3],n=t,r;while((r=e[4])&&r.length)e=r[r.length-1],n=e[3];return[t,n]}function g(e){function n(e,n,r){if(!t[e]){var i=g(n);t[e]=function(e,t){return i(e,t,r)}}return t[e]}var t={};return function(t,r,i){var s="",o,u;for(var a=0,f=e.length;a<f;++a){o=e[a];switch(o[0]){case"#":u=i.slice.apply(i,m(o)),s+=t._section(o[1],r,u,n(a,o[4],i));break;case"^":s+=t._inverted(o[1],r,n(a,o[4],i));break;case">":s+=t._partial(o[1],r);break;case"&":s+=t._name(o[1],r);break;case"name":s+=t._escaped(o[1],r);break;case"text":s+=o[1]}}return s}}function y(e){var t=[],n=t,r=[],i,s;for(var o=0;o<e.length;++o){i=e[o];switch(i[0]){case"#":case"^":i[4]=[],r.push(i),n.push(i),n=i[4];break;case"/":if(r.length===0)throw new Error("Unopened section: "+i[1]);s=r.pop();if(s[1]!==i[1])throw new Error("Unclosed section: "+s[1]);r.length>0?n=r[r.length-1][4]:n=t;break;default:n.push(i)}}s=r.pop();if(s)throw new Error("Unclosed section: "+s[1]);return t}function b(e){var t,n;for(var r=0;r<e.length;++r)t=e[r],n&&n[0]==="text"&&t[0]==="text"?(n[1]+=t[1],n[3]=t[3],e.splice(r--,1)):n=t}function w(e){if(e.length!==2)throw new Error("Invalid tags: "+e.join(" "));return[new RegExp(l(e[0])+"\\s*"),new RegExp("\\s*"+l(e[1]))]}var e={};e.name="mustache.js",e.version="0.7.0",e.tags=["{{","}}"],e.Scanner=p,e.Context=d,e.Writer=v;var t=/\s*/,n=/\s+/,r=/\S/,i=/\s*=/,s=/\s*\}/,o=/#|\^|\/|>|\{|&|=|!/,f=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};e.escape=h,p.prototype.eos=function(){return this.tail===""},p.prototype.scan=function(e){var t=this.tail.match(e);return t&&t.index===0?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):""},p.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return t},d.make=function(e){return e instanceof d?e:new d(e)},d.prototype.clearCache=function(){this._cache={}},d.prototype.push=function(e){return new d(e,this)},d.prototype.lookup=function(e){var t=this._cache[e];if(!t){if(e===".")t=this.view;else{var n=this;while(n){if(e.indexOf(".")>0){var r=e.split("."),i=0;t=n.view;while(t&&i<r.length)t=t[r[i++]]}else t=n.view[e];if(t!=null)break;n=n.parent}}this._cache[e]=t}return typeof t=="function"&&(t=t.call(this.view)),t},v.prototype.clearCache=function(){this._cache={},this._partialCache={}},v.prototype.compile=function(t,n){var r=this._cache[t];if(!r){var i=e.parse(t,n);r=this._cache[t]=this.compileTokens(i,t)}return r},v.prototype.compilePartial=function(e,t,n){var r=this.compile(t,n);return this._partialCache[e]=r,r},v.prototype.compileTokens=function(e,t){var n=g(e),r=this;return function(e,i){if(i)if(typeof i=="function")r._loadPartial=i;else for(var s in i)r.compilePartial(s,i[s]);return n(r,d.make(e),t)}},v.prototype.render=function(e,t,n){return this.compile(e)(t,n)},v.prototype._section=function(e,t,n,r){var i=t.lookup(e);switch(typeof i){case"object":if(f(i)){var s="";for(var o=0,u=i.length;o<u;++o)s+=r(this,t.push(i[o]));return s}return i?r(this,t.push(i)):"";case"function":var a=this,l=function(e){return a.render(e,t)};return i.call(t.view,n,l)||"";default:if(i)return r(this,t)}return""},v.prototype._inverted=function(e,t,n){var r=t.lookup(e);return!r||f(r)&&r.length===0?n(this,t):""},v.prototype._partial=function(e,t){!(e in this._partialCache)&&this._loadPartial&&this.compilePartial(e,this._loadPartial(e));var n=this._partialCache[e];return n?n(t):""},v.prototype._name=function(e,t){var n=t.lookup(e);return typeof n=="function"&&(n=n.call(t.view)),n==null?"":String(n)},v.prototype._escaped=function(t,n){return e.escape(this._name(t,n))},e.parse=function(r,u){function g(){if(v&&!m)while(d.length)h.splice(d.pop(),1);else d=[];v=!1,m=!1}u=u||e.tags;var f=w(u),c=new p(r),h=[],d=[],v=!1,m=!1,E,S,x,T;while(!c.eos()){E=c.pos,x=c.scanUntil(f[0]);if(x)for(var N=0,C=x.length;N<C;++N)T=x.charAt(N),a(T)?d.push(h.length):m=!0,h.push(["text",T,E,E+1]),E+=1,T==="\n"&&g();E=c.pos;if(!c.scan(f[0]))break;v=!0,S=c.scan(o)||"name",c.scan(t);if(S==="=")x=c.scanUntil(i),c.scan(i),c.scanUntil(f[1]);else if(S==="{"){var k=new RegExp("\\s*"+l("}"+u[1]));x=c.scanUntil(k),c.scan(s),c.scanUntil(f[1]),S="&"}else x=c.scanUntil(f[1]);if(!c.scan(f[1]))throw new Error("Unclosed tag at "+c.pos);h.push([S,x,E,c.pos]);if(S==="name"||S==="{"||S==="&")m=!0;S==="="&&(u=x.split(n),f=w(u))}return b(h),y(h)};var E=new v;return e.clearCache=function(){return E.clearCache()},e.compile=function(e,t){return E.compile(e,t)},e.compilePartial=function(e,t,n){return E.compilePartial(e,t,n)},e.compileTokens=function(e,t){return E.compileTokens(e,t)},e.render=function(e,t,n){return E.render(e,t,n)},e.to_html=function(t,n,r,i){var s=e.render(t,n,r);if(typeof i!="function")return s;i(s)},e}()),define("dialog",["mustache","jquery"],function(e){function n(e){this.init(e)}var t='<div class="page-dialog-wrapper"><div class="page-dialog {{type}}"><div class="title"><span class="text">{{title}}</span></div><div class="cont"><p class="detail"><span class="icon"></span><span class="text">{{{content}}}</span></p><div class="operation">{{#hasConfirmBtn}}<a class="btn confirm" href="javascript:;">确定</a>{{/hasConfirmBtn}}{{#hasCancelBtn}}<a class="btn secondary cancel" href="javascript:;">取消</a>{{/hasCancelBtn}}</div></div></div></div>';return n.prototype={init:function(e){var t=this;t.config(e),t.create()},config:function(e){var t=this;t.types=["info","error","ok","warn"],t.data={},t.data.type=typeof e.type=="string"?e.type:"info",t.data.title=function(e){var n;if(typeof e=="string"&&e!=="")n=e;else switch(t.type){case"ok":n="成功";break;case"error":n="错误";break;case"warn":n="警告";break;default:n="信息"}return n}(e.title),t.data.content=typeof e.content=="string"?e.content:"来自页面的信息",t.callback={},t.callback.confirm=typeof e.onConfirm=="function"?e.onConfirm:function(){},t.callback.cancel=typeof e.onCancel=="function"?e.onCancel:function(){},t.data.hasConfirmBtn=typeof e.confirmBtn=="boolean"?e.confirmBtn:!0,t.data.hasCancelBtn=typeof e.cancelBtn=="boolean"?e.cancelBtn:!1},create:function(){var n=this;n.dialog=$(e.render(t,n.data)),$("body").append(n.dialog);var r=n.dialog.find(".page-dialog");r.css({marginTop:-(r.outerHeight()/2),marginLeft:-(r.outerWidth()/2)}),n.dialog.on("click",".operation .confirm",function(){n.dialog.remove(),n.callback.confirm()}),n.dialog.on("click",".operation .cancel",function(){n.dialog.remove(),n.callback.cancel()}),n.dialog.find(".operation .confirm").focus(),n.dialog.find(".operation .confirm").blur()}},n});var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json2",function(){}),define("ajax",["dialog","json2"],function(e){var t={zh:{100:"未知错误",101:"被请求的页面需要用户名和密码",102:"请求未完成,服务器遇到不可预知的情况"},en:{100:"Unknown error",101:"The requested page needs a username and password",102:"The request was not completed, the server encounters unpredictable circumstances"}},n=function(e){try{JSON.parse(e)}catch(t){return!1}return!0},r=t[globalConfig.context.lang||"zh"],i={cache:!0,data:{},timeout:6e4,dataType:"json",type:"get",traditional:!1,jsonp:"callback",jsonpCallback:""};return{invoke:function(e){var t=this,n=$.extend({},i,e||{}),r=$.ajax({url:n.url,contentType:n.contentType,type:n.type,cache:n.cache,data:n.data,timeout:n.timeout,dataType:n.dataType,beforeSend:n.beforeSend,complete:n.complete,traditional:n.traditional,jsonp:n.jsonp,jsonpCallback:n.jsonpCallback,success:function(e){t.success(n,e)},error:function(e){t.error(n,e)}});return r},success:function(e,t){var n=this,t=t||{};typeof e.success=="function"&&e.success.apply(n,[t])},error:function(t,i){var s=this,o=i.responseText,u=i.status;switch(u){case 0:break;case 401:new e({type:"error",content:r[101],onConfirm:function(){location.href=location.href}});break;case 611:var a=JSON.parse(o);window.open(a.message,"_self");break;default:i=n(o)?JSON.parse(o):{message:r[100]},typeof t.failed=="function"?t.failed.apply(s,[i,u]):new e({type:"error",content:i.message})}}}}),require(["ajax","dialog","jquery"],function(e,t){var n={init:function(){var e=this;e.initDom(),e.initAttrs(),e.getInitialData(),e.initEvent()},initDom:function(){var e=this;e.mailText=$(".mail-box").find(".mail-text"),e.sendMailBtn=$('[data-action="send-mail"]')},initAttrs:function(){var e=this;e.resetUrl=globalConfig.context.path+"/pwdInfo/step_third?code="},initEvent:function(){var e=this;e.sendMailBtn.click(function(){e.submitForm()})},getInitialData:function(e){var t=this,n=t.getIdFromUrl("info");t.mailText.text(n)},getIdFromUrl:function(e){var t=this,n=window.location.search;if(n.indexOf("?")!=-1){var r=n.substr(1),i=r.split("&");for(var s=0;s<i.length;s++){var o=i[s].split("=");if(decodeURIComponent(o[0])===e)return decodeURIComponent(o[1])}}return},submitForm:function(){var n=this;n.usr=n.getIdFromUrl("usr");var r={usr:n.usr,resetUrl:n.resetUrl};e.invoke({url:"/pwdInfo/sendMail",type:"POST",data:JSON.stringify(r),contentType:"application/json",success:function(e){e.success&&new t({type:"ok",title:"提示",content:"发送成功"})},failed:function(e){e.success||new t({type:"error",title:"提示",content:e.message||"发送失败"})}})}};n.init()}),define("app/pwdInfo/step_second.js",function(){});